---
title: "FLEX_CREATE"
---

# Use FLEX_CREATE with BigQuery

This page describes how to use the `FLEX_CREATE` function in BigQuery.

## Examples

### Classification

```sql
SELECT `my_project.my_dataset`.FLEX_CREATE(
    "Did the customer request a refund?",
    "refund_request",
    "conversations"
);
```

### Extraction

```sql
SELECT `my_project.my_dataset`.FLEX_CREATE(
    "Did the customer mention a product issue? -> product",
    "issue_product",
    "conversations"
);
```

### Coupled-extraction

```sql
SELECT `my_project.my_dataset`.FLEX_CREATE(
    "Did the customer complain? -> product AS product, issue AS issue",
    "product_issues",
    "conversations"
);
```

### Categories

```sql
SELECT `my_project.my_dataset`.FLEX_CREATE(
    "Did the customer report an issue? -> issue type -> [Billing, Technical, Shipping, Account]",
    "issue_category",
    "conversations"
);
```

## Filter Results

Use `UNNEST` and `ARRAY_LENGTH` to filter out empty and `NA` results:

```sql
WHERE 'NA' NOT IN UNNEST(<column_name>)
    AND ARRAY_LENGTH(<column_name>) > 0
```

## Unnested View

Flexor provides an unnested view for Extraction and Category columns, where each value is displayed in a separate row.

```sql
SELECT *
FROM `my_project.my_dataset.conversations_unnested`
WHERE column_name LIKE "<column_name>";
```