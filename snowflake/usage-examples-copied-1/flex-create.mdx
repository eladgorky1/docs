---
title: "FLEX_CREATE"
---

# Use FLEX_CREATE with Databricks

This page describes how to use the `FLEX_CREATE` function in Databricks.

## Examples

### Classification

```sql
%sql
SELECT * FROM FLEX_CREATE(
    'Did the customer request a refund?',
    'refund_request',
    'conversations'
);
```

### Extraction

```sql
%sql
SELECT * FROM FLEX_CREATE(
    'Did the customer mention a product issue? -> product',
    'issue_product',
    'conversations'
);
```

### Coupled-extraction

```sql
%sql
SELECT * FROM FLEX_CREATE(
    'Did the customer complain? -> product AS product, issue AS issue',
    'product_issues',
    'conversations'
);
```

### Categories

```sql
%sql
SELECT * FROM FLEX_CREATE(
    'Did the customer report an issue? -> issue type -> [Billing, Technical, Shipping, Account]',
    'issue_category',
    'conversations'
);
```

## Filter Results

```sql
%sql
SELECT unnested_value 
    FROM <schema_name>.<table_name>
    LATERAL VIEW OUTER EXPLODE(<column_name>) exploded_table AS unnested_value
    WHERE SIZE(<column_name>) > 0 AND unnested_value != 'NA';
```

## Unnested View

Flexor provides an unnested view for Extraction and Category columns, where each value is displayed in a separate row.

```sql
%sql
SELECT *
FROM my_catalog.my_schema.<table_name>_unnested
WHERE column_name LIKE '<column_name>';
```